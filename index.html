<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JS</title>

    <!-- Bootstrap and deps -->
    <link rel="stylesheet" type="text/css" href="libs/bootstrap.min.css">
    <script type="text/javascript" src="libs/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="libs/bootstrap.bundle.min.js"></script>

    <!-- Our scripts -->
    <!-- Logic -->
    <script type="text/javascript" src="logic/calcClickHandler.js"></script>
    <script type="text/javascript" src="logic/phaseCountChangeHandler.js"></script>
    <script type="text/javascript" src="logic/helpers.js"></script>
    <script type="text/javascript" src="logic/calc.js"></script>
    <script type="text/javascript" src="logic/initTemplateFromValues.js"></script>
    <!-- Data and classes -->
    <script type="text/javascript" src="init_values.js"></script>
    <script type="text/javascript" src="Doms/FieldFabric.js"></script>
    <script type="text/javascript" src="Doms/PhaseBlock.js"></script>
    <script type="text/javascript" src="Doms/InputNumberField.js"></script>
    <script type="text/javascript" src="Doms/InputField.js"></script>
    <script type="text/javascript" src="Doms/SelectField.js"></script>
    <script type="text/javascript" src="formulas/Physical.js"></script>
    <!-- Main -->
    <script type="text/javascript" src="script.js"></script>

    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>



    <div class="mt-4 mb-4 container">

        <!-- Phase count -->
        <div id="phaseCountBlock" class="mb-4 phase-count-block">
            <div class="form-group">
                <label>Phase count</label>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <button class="btn btn-outline-danger" type="button" data-decrement-input="phaseCountInput">-</button>
                    </div>
                    <input id="phaseCountInput" class="form-control phase-count-input one-field-input" type="text" value="1" min="1" max="5" step="1">
                    <div class="input-group-append">
                        <button class="btn btn-outline-success" type="button" data-increment-input="phaseCountInput">+</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- One-field inputs -->
        <div id="oneFieldBlocksContainer" class="mb-4 one-field-blocks-container">
        </div>


        <!-- Phase count dependent block -->
        <div id="phaseBlocksContainer" class="phase-deps-container">
        </div>

        <button id="calculateButton" class="btn btn-outline-secondary">Calculate</button>

    </div>



    <script type="text/javascript">

        // Set + and - buttons event handlers (around number inputs)

        document.querySelectorAll('[data-decrement-input]').forEach((elem) => {
            elem.addEventListener('click', (event) => {
                var inputId = event.target.getAttribute('data-decrement-input');
                var input = document.getElementById(inputId);

                var min = input.getAttribute('min');
                var max = input.getAttribute('max');
                var step = input.getAttribute('step') || 1;

                var newValue = (+input.value - +step);

                if (Number.isInteger(newValue) && newValue >= input.getAttribute('min') && newValue <= input.getAttribute('max')) {
                    input.value = newValue;
                } else {
                    input.value = input.getAttribute('min');
                }

                var event = new Event('input');
                input.dispatchEvent(event);
            });
        });

        document.querySelectorAll('[data-increment-input]').forEach((elem) => {
            elem.addEventListener('click', (event) => {
                var inputId = event.target.getAttribute('data-increment-input');
                var input = document.getElementById(inputId);

                var min = input.getAttribute('min');
                var max = input.getAttribute('max');
                var step = input.getAttribute('step') || 1;

                var newValue = (+input.value + +step);

                if (Number.isInteger(newValue) && newValue >= input.getAttribute('min') && newValue <= input.getAttribute('max')) {
                    input.value = newValue;
                } else {
                    input.value = input.getAttribute('max');
                }

                var event = new Event('input');
                input.dispatchEvent(event);
            });
        });
    </script>



</body>
</html>
